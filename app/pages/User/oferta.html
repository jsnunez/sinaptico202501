<!DOCTYPE html>
<html lang="es">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>sinaptico - Innovaci√≥n Abierta</title>

  <link rel="stylesheet" href="styles/colores.css">
  <link rel="stylesheet" href="styles/stylehelice2.css">
  <link rel="stylesheet" href="styles/desplegables.css">
  <link rel="stylesheet" href="styles/menu.css">
  <link rel="stylesheet" href="styles/clasificados.css">


      <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Leaflet.js para mapas -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />


    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>

  <!-- Encabezado -->
  <header>
    <div class="header">
      <div onclick="window.location.href='/helice'">
        <!-- <span class="logo-icon">‚ö°</span> -->
        <img src="/img/logo1.png" alt="SINAPTICO" class="logo" style="height:8vh;">
      </div>
      <div style="display: flex; align-items: center; gap: 20px;">
        <div style="font-size:1.5em;cursor:pointer;">
          <span id="icono-notif">üîî <span
              style='background:red;color:white;border-radius:50%;padding:2px 7px;font-size:0.9em;'>0</span></span>
        </div>
        <div class="notificaciones" id="notificaciones"></div>


        <div class="dropdown">
          <button id="userMenuBtn" style="display: flex; align-items: center;">
            <div id="userPhoto ">
              <img class="imagenPerfil" id="imagenPerfilSecundaria" src="img/sinfoto.jpg" alt="Foto de perfil"
                onerror="this.onerror=null;this.src='img/sinfoto.jpg';">

            </div>
            <h3 id="nombreUsuarioHeader" style="color:white; margin-left:10px;">Usuario <i
                class="bi bi-chevron-down"></i> </h3>
          </button>

          <div class="dropdown-menu" id="userMenu">
            <a class="perfilUser" id="perfilUser">Perfil</a>
            <a id="habilitarMiEmpresa" style="display: none;">Empresa</a>
            <a href="#" id="cerrarSesion">Cerrar sesi√≥n</a>
          </div>
        </div>
      </div>
    </div>
    <nav class="nav">

      <button class="nav-button" data-link="/helice" id="inicio"
        onclick="window.location.href='/helice'">Inicio</button>

      <div class="dropdown menuG">
        <button class="nav-button dropdown-btnG" id="directorioButton" data-link="/directorio">Directorio</button>
        <div class="dropdown-menu dropdown-menuG">
          <a href="/directorio">Entidades</a>
          <a href="/directorioPersonas">Personas</a>
        </div>
      </div>
      <button class="nav-button" onclick="window.location.href='/proyectos'" data-link="/proyectos">Proyectos</button>
      <button class="nav-button" onclick="window.location.href='/ofertaRegional'" data-link="/ofertaRegional">Oferta
        Regional</button>
      <div class="dropdown menuG">
        <button class="nav-button dropdown-btnG" data-link="/retos">Innovaci√≥n Abierta</button>
        <div class="dropdown-menu dropdown-menuG">
          <a href="/retosEmpresariales">Retos Empresariales</a>
          <a href="/retosAula">Retos de Aula</a>
        </div>
      </div>

      <div class="dropdown menuG">
        <button class="nav-button dropdown-btnG" data-link="/conocimiento">Conocimiento Abierto</button>
        <div class="dropdown-menu dropdown-menuG">
          <a href="/conocimientoCursosVirtuales" data-link="/cursosVirtuales">Cursos</a>
          <a href="/conocimientoBiblioteca" data-link="/conocimientoBiblioteca">Biblioteca</a>
        </div>
      </div>
      <button class="nav-button" onclick="window.location.href='/convocatorias'">Convocatorias</button>

      <button class="nav-button" onclick="window.location.href='/eventos'">Eventos</button>

      <button class="nav-button" id="btnEvaluador" style="display: none;" data-link="/portalEvaluadorUser"
        onclick="window.location.href='/portalEvaluadorUser'">Evaluaci√≥n</button>

    </nav>
  </header>


  <!-- clasificados Section -->
  <section id="clasificados" class="main-content" style="display: block; margin-top: 3rem;">

    <div class="main-content">


      <section class="page-title">
        <h1>Muro de Servicios</h1>
      </section>

      <!-- Selector de tipo de servicio -->
      <div class="service-type-selector">
        <button class="service-type-btn active" data-type="offer">
          <i class="fas fa-hand-holding-usd"></i> Ofrecer mi servicio
        </button>
        <button class="service-type-btn" data-type="request">
          <i class="fas fa-search-dollar"></i> Solicitar servicios
        </button>


      </div>

      <div class="view-toggle">
        <button id="toggleViewBtn" class="btn">üìÉ Lista</button>

      </div>

      <!-- Filtros y controles -->
      <div class="board-controls">
        <div class="filter-tags">
          <span class="tag active" data-filter="all">Todos</span>
          <span class="tag" data-filter="dise√±o">Dise√±o</span>
          <span class="tag" data-filter="desarrollo">Desarrollo</span>
          <span class="tag" data-filter="marketing">Marketing</span>
          <span class="tag" data-filter="redacci√≥n">Redacci√≥n</span>
        </div>
        <div class="filter-tags">
          <span class="tag" data-filter="recent">Recientes</span>
          <span class="tag" data-filter="popular">Populares</span>
          <span class="tag" data-filter="featured">Destacados</span>
        </div>
      </div>

      <!-- Muro de clasificados -->
      <div class="classified-wall" id="classified-wall">
        <!-- Los clasificados se cargar√°n aqu√≠ din√°micamente -->
      </div>

    </div>
  </section>

  <!-- Create classified modal -->
  <div class="modal-backdrop" id="create-classified-modal">
    <div class="modalClasificado">
      <div class="modal-header">
        <h2 class="modal-title">Publicar un nuevo clasificado</h2>
        <p class="modal-description">Completa el formulario para publicar tu clasificado.</p>
      </div>
      <div class="modal-body">
        <form id="create-classified-form">
          <div class="form-group">
            <label for="classified-title" class="form-label">T√≠tulo del clasificado</label>
            <input type="text" id="classified-title" class="form-input" placeholder="Ej: Dise√±o de logotipo profesional"
              required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="classified-category" class="form-label">Categor√≠a</label>
              <select id="classified-category" class="form-select" required>
                <option value="">Seleccionar categor√≠a</option>
                <option value="Dise√±o gr√°fico">Dise√±o gr√°fico</option>
                <option value="Desarrollo web">Desarrollo web</option>
                <option value="Marketing digital">Marketing digital</option>
                <option value="Redacci√≥n">Redacci√≥n</option>
                <option value="Traducci√≥n">Traducci√≥n</option>
                <option value="Video y animaci√≥n">Video y animaci√≥n</option>
                <option value="M√∫sica y audio">M√∫sica y audio</option>
                <option value="Programaci√≥n">Programaci√≥n</option>
                <option value="Negocios">Negocios</option>
                <option value="Estilo de vida">Estilo de vida</option>
              </select>
            </div>

            <div class="form-group">
              <label for="classified-price" class="form-label">Precio/Presupuesto (COP)</label>
              <input type="text" id="classified-price" class="form-input" placeholder="Ej: 100000" required>
            </div>
          </div>

          <div class="form-group">
            <label for="classified-description" class="form-label">Descripci√≥n</label>
            <textarea id="classified-description" class="form-input form-textarea"
              placeholder="Describe detalladamente tu servicio o solicitud..." required></textarea>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="classified-delivery" class="form-label">Tiempo de entrega</label>
              <select id="classified-delivery" class="form-select" required>
                <option value="">Seleccionar tiempo</option>
                <option value="24 horas">24 horas</option>
                <option value="3 d√≠as">3 d√≠as</option>
                <option value="7 d√≠as">7 d√≠as</option>
                <option value="14 d√≠as">14 d√≠as</option>
                <option value="30 d√≠as o m√°s">30 d√≠as o m√°s</option>
              </select>
            </div>

            <div class="form-group">
              <label for="classified-location" class="form-label">Ubicaci√≥n</label>
              <input type="text" id="classified-location" class="form-input" placeholder="Ej: Bucaramanga,Colombia"
                required>
            </div>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="cancel-classified-btn">Cancelar</button>
        <button class="btn btn-primary" id="submit-classified-btn">Publicar clasificado</button>
      </div>
    </div>
  </div>

  <!-- Contact classified modal -->
  <div class="modal-backdrop" id="contact-classified-modal">
    <div class="modalClasificado">
      <div class="modal-header">
        <h2 class="modal-title">Contactar por este clasificado</h2>
        <p class="modal-description">Est√°s contactando por: <span id="contact-classified-title"
            class="font-medium"></span></p>
      </div>
      <div class="modal-body">
        <form id="contact-classified-form">
          <div class="form-group">
            <label for="contact-name" class="form-label">Nombre completo</label>
            <input type="text" id="contact-name" class="form-input" placeholder="Tu nombre completo" required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="contact-email" class="form-label">Correo electr√≥nico</label>
              <input type="email" id="contact-email" class="form-input" placeholder="tu@email.com" required>
            </div>

            <div class="form-group">
              <label for="contact-phone" class="form-label">Tel√©fono</label>
              <input type="text" id="contact-phone" class="form-input" placeholder="+57 600 000 000">
            </div>
          </div>

          <div class="form-group">
            <label for="contact-message" class="form-label">Mensaje</label>
            <textarea id="contact-message" class="form-input form-textarea"
              placeholder="Escribe tu mensaje o propuesta..." required></textarea>
          </div>
        </form>
      </div>
      <div class="modal-footer">
        <button class="btn btn-outline" id="cancel-contact-btn">Cancelar</button>
        <button class="btn btn-primary" id="submit-contact-btn">Enviar mensaje</button>
      </div>
    </div>
  </div>


  <div id="modalCrearReto" class="modal" style="display: none;">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h2 style="text-align: center;">Nuevo Reto</h2>
      <form id="crearRetoForm">
        <div class="form-section">
          <div class="input-box ">
            <label for="nombre">Nombre del Reto:</label>
            <input type="text" id="nombre" name="nombre" required>

            <label for="ubicacionVideo">Video promotor:</label>
            <input type="file" id="video" name="video" accept="video/*">

            <label for="descripcion">Descripci√≥n:</label>
            <textarea id="descripcion" name="descripcion"></textarea>

            <label for="ubicacionFicha">Ficha de Requisitos:</label>
            <input type="file" id="ficha" name="ficha" accept=".pdf,.doc,.docx">
          </div>
        </div>
        <button type="submit" class="modal-button">Crear Reto</button>

      </form>
    </div>
  </div>
  <!-- Spinner de carga de p√°gina -->
  <div id="page-spinner-overlay" aria-hidden="true" role="status" aria-label="Cargando">
    <div class="spinner" aria-hidden="true"></div>
    <div class="spinner-text">Cargando...</div>
  </div>

    <footer class="footer">

        <div class="footer-content">

            <!-- Izquierda -->
            <div class="footer-left">
                <img src="/img/logo1.png" alt="SINAPTICO" class="footer-logo">
                <p class="footer-desc">Conectando conocimiento, innovaci√≥n y tecnolog√≠a.</p>


            </div>

            <!-- Enlaces en dos columnas -->
            <div class="footer-links">
                <h4>Explorar</h4>
                <div class="links-grid">
                    <a href="/helice">Inicio</a>
                    <a></a>
                    <a href="/directorio">Directorio Empresas</a>
                    <a href="/directorioPersonas">Directorio Personas</a>
                    <a href="/proyectos">Proyectos</a>
                    <a href="/ofertaRegional">Oferta Regional</a>
                    <a href="/retosEmpresariales">Retos Empresariales</a>
                    <a href="/retosAula">Retos de Aula</a>
                    <a href="/conocimientoCursosVirtuales">Cursos</a>
                    <a href="/conocimientoBiblioteca">Biblioteca</a>
                    <a href="/convocatorias">Convocatorias</a>
                    <a href="/eventos">Eventos</a>
                </div>
            </div>

            <!-- Redes sociales -->
            <div class="footer-social">
                <h4>S√≠guenos</h4>
                <div class="social-icons">
                    <a href="#"><i class="bi bi-facebook"></i></a>
                    <a href="#"><i class="bi bi-twitter"></i></a>
                    <a href="#"><i class="bi bi-linkedin"></i></a>
                    <a href="#"><i class="bi bi-instagram"></i></a>
                </div>
            </div>

            <!-- Contacto -->
            <div class="footer-contact">
                <h4>Cont√°ctanos</h4>

                <p>Cra.19 #35-02 - UIS Bucarica</p>
                <p>Bucaramanga, Colombia</p>

                <div class="contact-item">
                    <i class="bi bi-envelope"></i>
                    <span>info@cpcoriente.org</span>
                </div>

                <div class="contact-item">
                    <i class="bi bi-telephone"></i>
                    <span>+57 315 494 0296</span>
                </div>
            </div>

        </div>

        <div class="footer-bottom">
            <img src="/logos/logoCPCblanco.png" alt="SINAPTICO" class="footer-logoCPC">
            <p>¬© 2025 CPC Oriente. Todos los derechos reservados.</p>

        </div>

    </footer>


  <script src="/js/config.js"></script>
  <script src="/js/nav.js"></script>
  <script src="js/notificaciones.js"></script>
  <script src="/js/websocket.js"></script>
  <script src="/js/habilitarEvaluador.js"></script>
  <script src="/js/menuGeneral.js"></script>
  <script src="js/clasificadosMostrar.js"></script>
  <script src="js/ContactarServicio.js"></script>





  <!-- Formulario de clasificados -->
  <script>

    const userid = document.cookie.split("; ").find(row => row.startsWith("userId="))?.split("=")[1];

    const priceInput = document.getElementById('classified-price');

    priceInput.addEventListener('input', (e) => {
      // Captura solo d√≠gitos
      let raw = e.target.value.replace(/\D/g, '');

      // Evita errores si est√° vac√≠o
      if (!raw) {
        e.target.value = '';
        return;
      }

      // Formatea con separadores de miles
      const formatted = raw.replace(/\B(?=(\d{3})+(?!\d))/g, '.');
      e.target.value = formatted;
    });

    // Eliminar puntos antes de enviar al servidor
    document.querySelector('form').addEventListener('submit', (e) => {
      const input = document.getElementById('classified-price');
      input.value = input.value.replace(/\./g, ''); // Enviar n√∫mero limpio al backend
    });
  </script>


  <script>
    const toggleViewBtn = document.getElementById('toggleViewBtn');
    const classifiedWall = document.querySelector('.classified-wall');

    toggleViewBtn.addEventListener('click', () => {
      const isList = classifiedWall.classList.toggle('list-view');

      // Cambiar √≠cono/texto seg√∫n el modo actual
      toggleViewBtn.textContent = isList ? 'üü¶ Cuadr√≠cula' : 'üìÉ Lista';
    });

    // ‚úÖ Funci√≥n para verificar si el usuario pertenece a una entidad
    async function verificarUsuarioEntidad(userId) {
      const response = await fetch(`${API_BASE_URL}/api/usuarioempresa/user/${userId}`);
      const data = await response.json();
      return data; // { exists: true, entidad: {...} }
    }
  </script>

</body>

</html>
<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SINAPTICO</title>

    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>

    <link rel="stylesheet" href="styles/colores.css">
    <link rel="stylesheet" href="styles/stylehelice2.css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons/font/bootstrap-icons.css" rel="stylesheet">
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <!-- Leaflet.js para mapas -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
</head>

<body>
    <!-- Encabezado -->
    <header>
        <div class="header">
            <div onclick="window.location.href='/helice'">
                <!-- <span class="logo-icon">âš¡</span> -->
                <img src="/img/logo1.png" alt="SINAPTICO" class="logo" style="height:8vh;">
            </div>
            <div style="display: flex; align-items: center; gap: 20px;">
                <div style="font-size:1.5em;cursor:pointer;">
                    <span id="icono-notif">ðŸ”” <span
                            style='background:red;color:white;border-radius:50%;padding:2px 7px;font-size:0.9em;'>0</span></span>
                </div>
                <div class="notificaciones" id="notificaciones"></div>


                <div class="dropdown">
                    <button id="userMenuBtn" style="display: flex; align-items: center;">
                        <div id="userPhoto ">
                            <img class="imagenPerfil" id="imagenPerfilSecundaria" src="img/sinfoto.jpg"
                                alt="Foto de perfil" onerror="this.onerror=null;this.src='img/sinfoto.jpg';">

                        </div>
                        <h3 id="nombreUsuarioHeader" style="color:white; margin-left:10px;">Usuario <i
                                class="bi bi-chevron-down"></i> </h3>
                    </button>

                    <div class="dropdown-menu" id="userMenu">
                        <a href="/perfil">Perfil</a>
                        <a href="/perfilEntidad">Empresa</a>
                        <a href="#" id="cerrarSesion">Cerrar sesiÃ³n</a>
                    </div>
                </div>
            </div>
        </div>
        <nav class="nav">
            <button class="nav-button pulse" onclick="window.location.href='/helice'" id="inicio">Inicio</button>
            <button class="nav-button" id="directorioButton">Directorio</button>

            <button class="nav-button" onclick="window.location.href='/proyectos'">Proyectos</button>
            <button class="nav-button" onclick="window.location.href='/innovacion'">InnovaciÃ³n</button>

            <button class="nav-button" onclick="window.location.href='/Conocimiento'">Conocimiento</button>
            <button class="nav-button" onclick="window.location.href='/convocatorias'">Convocatorias</button>

            <button class="nav-button" onclick="window.location.href='/eventos'">Eventos</button>

        </nav>
    </header>

    <!-- Scripts -->

    <script src="js/notificaciones.js"></script>
    <script src="/js/websocket.js"></script>
    <script src="/js/config.js"></script>

    <!-- MenÃº desplegable -->
    <script>
        const userMenuBtn = document.getElementById("userMenuBtn");
        const dropdown = userMenuBtn.closest(".dropdown");

        function obtenerCookie(nombre) {
            const nombreCookie = `${nombre}=`;
            const cookies = document.cookie.split(';');
            for (let i = 0; i < cookies.length; i++) {
                let cookie = cookies[i].trim();
                if (cookie.indexOf(nombreCookie) === 0) {
                    return cookie.substring(nombreCookie.length, cookie.length);
                }
            }
            return null;
        }

        // const userId = obtenerCookie("userId");

        // const usuario = obtenerCookie("user");
        // const userData = cargarDatosUsuario(userId);

        // let cleanedStr = decodeURIComponent(usuario.replace(/%20/g, " "));
        // let nombreUsuario = cleanedStr.split(" ")[0];

        // async function cargarDatosUsuario(userId) {
        //     console.log("isss", userId)
        //     const response = await fetch(`${API_BASE_URL}/api/user/${userId}`);
        //     const data = await response.json();

        //     document.getElementById("imagenPerfilSecundaria").src = data.fotoPerfil ? "photo/" + data.fotoPerfil : "photo/sinfoto.jpg";

        //     document.getElementById('nombreUsuarioHeader').innerHTML = `${nombreUsuario} <i class="bi bi-chevron-down"></i>`;


        //     console.log(data);
        //     return data;
        // }


        // Mostrar / ocultar el menÃº al hacer clic
        userMenuBtn.addEventListener("click", (event) => {
            event.stopPropagation(); // evita que el clic cierre inmediatamente el menÃº
            dropdown.classList.toggle("show");
        });

        // Cerrar el menÃº si haces clic fuera
        document.addEventListener("click", () => {
            dropdown.classList.remove("show");
        });
    </script>

</body>
</html>